(this.webpackJsonppetit_bac_app_react=this.webpackJsonppetit_bac_app_react||[]).push([[0],{117:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(13),u=n.n(c),o=n(4),l=n(17),i=n(55),s=n(7),m=n(8),p=n.n(m),b={token:null,currentUser:null,status:null,isLoading:!0,isRegistered:!1,isLogged:!1},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN_SUCCESS":return Object(s.a)(Object(s.a)({},e),{},{type:"LOGIN_SUCCESS",token:t.user.token,currentUser:t.user.user,isLoading:!1,isRegistered:!0,isLogged:!0});case"LOGIN_FAIL":return Object(s.a)(Object(s.a)({},e),{},{type:"LOGIN_FAIL",status:t.status,isLoading:!1});case"LOGIN_LOADING":return Object(s.a)(Object(s.a)({},e),{},{type:"LOGIN_LOADING",status:t.status});case"REGISTER_SUCCESS":return Object(s.a)(Object(s.a)({},e),{},{type:"REGISTER_SUCCESS",user:t.user,status:t.status,isLoading:!1,isRegistered:!0});case"LOGOUT_SUCCESS":return p.a.remove("token"),p.a.remove("user"),Object(s.a)(Object(s.a)({},e),{},{token:null,currentUser:null,isLogged:!1,isRegistered:!1});default:return e}},f=Object(l.c)({auth:g}),d=Object(l.d)(f,Object(l.a)(i.a));d.subscribe((function(){return console.log(d.getState())}));var E=d,h=(n(69),n(1)),O=n(11),j=n.n(O),v=n(15),y=n(28),S=function(e){var t=e.tg,n=Object(a.useState)([]),c=Object(h.a)(n,2),u=c[0],o=c[1],l=Object(a.useState)([]),i=Object(h.a)(l,2),s=i[0],m=i[1],p="https://api-petitbac.herokuapp.com/";Object(a.useEffect)((function(){function e(){return(e=Object(v.a)(j.a.mark((function e(){var t,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(p,"categories"),{method:"GET",headers:{"Content-Type":"application/json"}});case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,o(n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]);return Object(a.useEffect)((function(){t(s)}),[s]),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement("h1",null," All Cat\xe9gories"),r.a.createElement("ul",null,u.map((function(e){return r.a.createElement("li",{key:e.id,onClick:function(){return function(e){o(u.filter((function(t){return t.id!==e.id}))),m([].concat(Object(y.a)(s),[e]))}(e)}},e.name)}))),r.a.createElement("h1",null," Selected Cat\xe9gories"),r.a.createElement("ul",{className:"categories"},s.map((function(e){return r.a.createElement("li",{key:e.id},e.name)})))))},k=function(e){var t=e.isGameReady,n=e.gameIdForHome,c=Object(o.c)((function(e){return e.auth.currentUser})),u=(Object(o.c)((function(e){return e.auth})),Object(a.useState)("")),l=Object(h.a)(u,2),i=l[0],s=l[1],m=Object(a.useState)([]),b=Object(h.a)(m,2),g=b[0],f=b[1],d=Object(a.useState)([]),E=Object(h.a)(d,2),O=E[0],y=E[1],k=Object(a.useState)(""),C=Object(h.a)(k,2),_=C[0],L=C[1],I=Object(a.useState)(!1),x=Object(h.a)(I,2),w=x[0],G=x[1],N=Object(a.useState)(!1),U=Object(h.a)(N,2),F=U[0],T=U[1],R=function(){var e=Object(v.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),f(document.getElementsByClassName("categories")[0].innerText.split("\n")),A(c,i),T(!0),console.log(O),console.log(_);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),A=function(e,t){console.log(i,e,g);var n={game:{creator_id:e.id,winner_id:null,max_guests:t}};fetch("".concat("https://api-petitbac.herokuapp.com/","games"),{method:"post",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(p.a.get("token"))},body:JSON.stringify(n)}).then((function(e){return e.json()})).then((function(e){return L(e.id)})),console.log(_),console.log(O)},q=function(e,t){var n={join_category_game:{game_id:e,category_id:t}};fetch("".concat("https://api-petitbac.herokuapp.com/","join_category_games"),{method:"post",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(p.a.get("token"))},body:JSON.stringify(n)}).then((function(e){return!0===e.ok?(G(!0),e.json()):e}))};return function(e){O.forEach((function(t){console.log(e),console.log(t.id),q(e,t.id),console.log(w)})),t(w),n(e)}(_),r.a.createElement(r.a.Fragment,null,!F&&r.a.createElement("div",null,r.a.createElement("h1",null,"Game creation"),r.a.createElement("form",{onSubmit:R},r.a.createElement("input",{type:"number",value:i,onChange:function(e){return s(e.target.value)},placeholder:"max player"}),r.a.createElement(S,{tg:function(e){return y(e)}}),r.a.createElement("input",{type:"submit",value:"Envoyer"}))),F&&r.a.createElement(r.a.Fragment,null))},C=n(3),_=(n(71),n(6)),L=Object(_.a)(),I=function(e){var t=e.data,n=Object(a.useState)(t),c=Object(h.a)(n,2),u=c[0];c[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement("p",null," le score est de : ",u),r.a.createElement("button",{onClick:L.push("/signup")},"Rejouer"),r.a.createElement("button",null,"Voir les scores finaux")))},x=function(e){var t=e.dataResults,n=Object(a.useState)([]),c=Object(h.a)(n,2),u=c[0],o=c[1],l=Object(a.useState)(0),i=Object(h.a)(l,2),s=i[0],m=i[1],p=Object(a.useState)(0),b=Object(h.a)(p,2),g=b[0],f=b[1];Object(a.useEffect)((function(){o.apply(void 0,Object(y.a)(u).concat([t]))}),[]),console.log(u),console.log(g),console.log(s),console.log(g+" from outside");var d=function(e){f(g+1),m(s+e),console.log(s),console.log(g)};return r.a.createElement(r.a.Fragment,null,g!==Object.keys(u).length&&r.a.createElement("div",null,r.a.createElement("h1",null,"GameMarking"),r.a.createElement("ul",{style:{listStyle:"none"}},Object.keys(u).map((function(e){return r.a.createElement("li",null,u[e],r.a.createElement("button",{onClick:function(){return d(1)}},"V"),r.a.createElement("button",{onClick:function(){return d(-1)}},"X"))})))),g===Object.keys(u).length&&r.a.createElement(I,{data:s}))},w=function(e){var t=Object(a.useState)([]),n=Object(h.a)(t,2),c=n[0],u=n[1],l=Object(a.useState)({}),i=Object(h.a)(l,2),m=i[0],p=i[1],b=Object(a.useState)(e),g=Object(h.a)(b,2),f=g[0],d=(g[1],Object(o.c)((function(e){return e.auth}))),E=Object(a.useState)(!1),O=Object(h.a)(E,2),y=O[0],S=O[1];Object(C.f)();console.log(f.gameId),console.log(e.gameId+"from gameGrid"),Object(a.useEffect)((function(){function e(){return(e=Object(v.a)(j.a.mark((function e(){var t,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u([]),"https://api-petitbac.herokuapp.com/",e.next=4,fetch("".concat("https://api-petitbac.herokuapp.com/","/games/").concat(f.gameId),{method:"get",headers:{"Content-Type":"application/json"}});case 4:return t=e.sent,e.next=7,t.json();case 7:n=e.sent,console.log(n),u(n[1]);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[y]),console.log(c);return r.a.createElement(r.a.Fragment,null,!y&&r.a.createElement("div",null,r.a.createElement("h1",null,"Game Grid"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),S(!0),p({stop:!0,user_id:d.currentUser.id});var t={};c.map((function(n){return t[n.name]=e.target.elements.namedItem(n.name).value})),p(Object(s.a)(Object(s.a)({},m),t)),console.log(m)}},c.map((function(e){return r.a.createElement("div",{key:e.id},r.a.createElement("span",null,e.name),r.a.createElement("input",{type:"text",name:e.name}),r.a.createElement("br",null))})),r.a.createElement("input",{type:"submit",value:"STOP"}))),y&&r.a.createElement(x,{dataResults:m}))},G=function(e){var t=e.gameId;return r.a.createElement(r.a.Fragment,null,r.a.createElement(w,{gameId:t}))},N=function(){var e=Object(o.c)((function(e){return e.auth.currentUser})),t=Object(a.useState)(),n=Object(h.a)(t,2),c=n[0],u=n[1],l=Object(a.useState)(""),i=Object(h.a)(l,2),s=i[0],m=i[1];return console.log(c),console.log(s),r.a.createElement(r.a.Fragment,null,null==e&&r.a.createElement("h1",null," HOME "),e&&r.a.createElement("div",null,r.a.createElement("h1",null," HOME "),r.a.createElement(k,{isGameReady:function(e){return u(e)},gameIdForHome:function(e){return m(e)}})),1==c&&r.a.createElement("div",null,r.a.createElement(G,{gameId:s})))},U=function(){var e=Object(v.a)(j.a.mark((function e(t,n){var a,r,c,u,o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://api-petitbac.herokuapp.com/",a={user:{email:t,password:n}},e.next=4,fetch("".concat("https://api-petitbac.herokuapp.com/","login"),{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});case 4:return r=e.sent,e.prev=5,e.next=8,r.headers.get("authorization").split(" ")[1];case 8:return c=e.sent,e.next=11,r.json();case 11:return u=e.sent,o={token:c,user:u},e.abrupt("return",o);case 16:e.prev=16,e.t0=e.catch(5),console.error(e.t0),alert("Aucun utilisateur correspondant");case 20:case"end":return e.stop()}}),e,null,[[5,16]])})));return function(t,n){return e.apply(this,arguments)}}(),F=function(){var e=Object(o.b)(),t=Object(o.c)((function(e){return e.auth.isLogged})),n=Object(a.useState)(""),c=Object(h.a)(n,2),u=c[0],l=c[1],i=Object(a.useState)(""),s=Object(h.a)(i,2),m=s[0],b=s[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null," Login "),r.a.createElement("div",null,!t&&r.a.createElement("form",{onSubmit:function(t){t.preventDefault(),U(u,m).then((function(t){e({type:"LOGIN_SUCCESS",user:t,isLogged:!0}),p.a.set("token",t.token),p.a.set("user",t.user)}))}},r.a.createElement("input",{type:"text",placeholder:"email",value:u,onChange:function(e){return l(e.target.value)},required:!0}),r.a.createElement("input",{type:"password",placeholder:"password",value:m,onChange:function(e){return b(e.target.value)},required:!0}),r.a.createElement("input",{type:"submit",value:"Envoyer"})),t&&r.a.createElement("p",null,"Connexion r\xe9ussie")))},T=function(){var e=Object(o.c)((function(e){return e.auth.isRegistered})),t=Object(a.useState)(""),n=Object(h.a)(t,2),c=n[0],u=n[1],l=Object(a.useState)(""),i=Object(h.a)(l,2),s=i[0],m=i[1],p=Object(a.useState)(""),b=Object(h.a)(p,2),g=b[0],f=b[1],d=Object(a.useState)(""),E=Object(h.a)(d,2),O=E[0],j=E[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"Sign up"),r.a.createElement("div",null,!e&&r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),function(e,t,n,a){var r={user:{email:e,password:t,password_confirmation:n,username:a}};fetch("".concat("https://api-petitbac.herokuapp.com/","signup"),{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}).then((function(e){return e.json()})).catch((function(e){return console.error(e)}))}(c,s,g,O)}},r.a.createElement("input",{type:"text",placeholder:"email",value:c,onChange:function(e){return u(e.target.value)},required:!0}),r.a.createElement("input",{type:"text",placeholder:"username",value:O,onChange:function(e){return j(e.target.value)},required:!0}),r.a.createElement("input",{type:"password",placeholder:"password",value:s,onChange:function(e){return m(e.target.value)},required:!0}),r.a.createElement("input",{type:"password",placeholder:"password_confirmation",value:g,onChange:function(e){return f(e.target.value)},required:!0}),r.a.createElement("input",{type:"submit",value:"Envoyer"})),e&&r.a.createElement("p",null,"Inscription r\xe9ussie")))},R=n(118),A=n(14),q=function(){var e=Object(o.b)();return r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("div",{className:"App"},r.a.createElement(R.a,{type:"primary"},r.a.createElement(A.b,{to:"/"},"Home")))),r.a.createElement("li",null,r.a.createElement(A.b,{to:"/login"},"Login")),r.a.createElement("li",null,r.a.createElement(A.b,{to:"/signup"},"Signup")),r.a.createElement("li",null,r.a.createElement("button",{onClick:function(){fetch("".concat("https://api-petitbac.herokuapp.com/","logout"),{method:"delete",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(p.a.get("token"))}}),e({type:"LOGOUT_SUCCESS",token:null,currentUser:null,isLogged:!1})}},"Logout")))},D=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"This is a simple react app!"),r.a.createElement(A.a,{history:L},r.a.createElement(q,null),r.a.createElement(C.c,null,r.a.createElement(C.a,{path:"/login"},r.a.createElement(F,null)),r.a.createElement(C.a,{path:"/signup"},r.a.createElement(T,null)),r.a.createElement(C.a,{path:"/current_game"},r.a.createElement(G,null)),r.a.createElement(C.a,{exact:!0,path:"/"},r.a.createElement(N,null)))))};u.a.render(r.a.createElement(o.a,{store:E},r.a.createElement(D,null)),document.querySelector("#root"))},60:function(e,t,n){e.exports=n(117)},69:function(e,t,n){}},[[60,1,2]]]);
//# sourceMappingURL=main.7858de4e.chunk.js.map